# Шаблон SV устройства и тестбенча cocotb

Данный шаблон удобен для быстрого получения каркаса для отладки устройств, написанных на Verilog или SystemVerilog, с использованием фреймворка сocotb и open source симуляторов [icarus](https://github.com/steveicarus/iverilog) и [verilator](https://www.veripool.org/verilator/).

## Предварительные условия

1. На компьютере пользователя должен быть установлен один, а лучше оба симулятора, python3 и пакет cocotb.

## Использование шаблона

1. Клонировать репозиторий. 
2. RTL файлы размещать в каталоге hw/rtl
3. Отредактировать файл dv/cocotb/Makefile, добавив в него имена и пути к rtl файлам.
4. Написать тест dv/cocotb/test_dut. В случае переименования данного файла исправить его имя и в Makefile.
5. Моделирование с помощью iverilog. 

Обычно выполняется быстрее за счет более быстрой компиляции, однако поддержка SystemVerilog в данном симуляторе хуже, чем в verilator. Запуск моделирования выполняется из папки dv/cocotb следующей командой.

```
make
```
Если требуется запись временных диаграмм, то запускать следует с установленной переменной WAVES:

```
WAVES=1 make
```
Временная диаграмма будет записана в файле с расширением .fst в каталоге build и может быть просмотрена с помощью open-source программы анализа временных диаграмм [GtkWave](https://gtkwave.sourceforge.net/)

6. Моделирование с помощью verilator.

Verilator имеет более полную поддержку конструкций SystemVerilog, кроме этого, позволяет получить информацию о покрытии кода при выполении тестирования.  Запуск моделирования выполняется из папки dv/cocotb следующей командой.

```
SIM=verilator make
```
Либо можно сразу установить эту переменную в Makefile.

Временная диаграмма будет записана в файле с расширением .fst в каталоге build. 
Для получения информации о покрытии кода необходимо выполнить команду.

```
make coverage
```

7. Для удаления временных файлов можно использовать команду

```
make rm
```

## Дополнительные источники информации

[О cocotb на accurate-rtl](https://accurate-rtl.ru/EDA/cocotb.html)






